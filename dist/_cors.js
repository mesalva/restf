"use strict";function _cors(i,l){return function(e,r,s){var t=parseHosts(i),o=getOrigin(e.headers);if(0===t.length||!o)return setCors(r,"*"),s();var n=o.replace(/http(s)?:\/\//,"");return t.includes(n)?(setCors(r,o,l),"OPTIONS"!==e.method?s():r.send()):(r.status(403),r.send())}}function parseHosts(e){return Array.isArray(e)?e:"string"==typeof e?e.replace(/\s/g,"").split(","):[]}function getOrigin(e){return e.origin||""}function setCors(e,r,s){e.setHeader("Access-Control-Allow-Headers",s=void 0===s?"*":s),e.setHeader("Access-Control-Allow-Methods","GET,POST,DELETE,PUT,OPTIONS,HEADERS"),e.setHeader("Access-Control-Allow-Origin",r),e.setHeader("Access-Control-Allow-Credentials","true")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=_cors;